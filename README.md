# IRIS (Integrated Rocket Intelligence System)
![image](assets/render.png)
## What is it
IRIS is an advanced flight computer designed for controlling guided model rockets. It is specifiacally designed for aerodynamic control, but is also capable of thrust vector control.
## Interfaces
IRIS has 6 pyrotechnic channels with a shared arming circuit. The continuity of each channel may be individually sensed. Each pyro channel may be independently controlled. There is also a physical arming switch for safety.  
It has 4 servo output channels, on the main microcontroller's dedicated pwm output pins so they incur no extra cpu load.  
It has a controlled output camera power header, to lower power draw while idling on the pad or waiting for recovery.  
There is a UART broken out from each microcontroller for debugging purposes, just in case the USB doesn't work.  
Finally, IRIS has a high performance lora transceiver onboard for long range telemetry, ensuring that even the highest flights may be safely flown and recovered.
## What's on it
IRIS has 2 high performance imus, one for lower range higher precision sensing, and one for higher range lower precision sensing. By having dedicated imus for each range, IRIS can maintain a high precision across the entire flight envelope.  
IRIS also includes an ultra high g accelerometer (which will not be populated on the prototype boards for cost reasons), a high performance high sensitivity magnetometer, and an ultra high sensitivity barometer. There is additionally a GPS for stable position updates.  
By fusing all of its sensors IRIS can create an accurate vehicle position esitmate across a wide range of flight profiles. This position estimate may then be used in GNC (Guidance, Navigation, and Control) algorithms to control the flight of a vehicle.  
#### Design Reasoning
IRIS uses 2 microcontrollers, one main processor and one auxilary processor. By using this architecture, one fast processor with lots of ram (the STM32U585 in this case) can handle all of the complex GNC logic that needs super consistent loop times to work. The main processor is in charge of all flight logic and servo control, as well as the sensors. However, we need to also be able to handle very inconsistent actions like telemetry and datalogging. To do that, we use the auxilary processor (the STM32U073 in this case). The auxilary processor is in charge of the pyrotechnic channels (not controlling them, basically just acting as an I/O expander), as well as datalogging to both flash and micro sd, plus sending telemetry.  
IRIS switches both the high and low side of the pyro channels, which is entirely about safety - that way there can be a device level digital and physical arm. You can never be too safe with pyrotechnics.  
IRIS uses a very comprehensive suite of sensors, including some quite high quality ones. This is to ensure that at least one sensor of each type is never out of range, which would lead to the position estimate being off, thus the GNC going out of control. I don't think I need to say this, but an out of control rocket is not a good thing.  
Everything that I chose was chosen for safety or so that IRIS could actually fulfil its intended purpose.
#### About  
This project was made for blueprint, an event ran by Hack Club. Hack Club is a global nonprofit that runs events like this, where teenagers learn valuable skills, like hardware design and programming. You can learn more about my project on the blueprint site, at [my project page](https://blueprint.hackclub.com/projects/486).  
#### Note
No more firmware development will be done on this repository, we don't want to take the risk of ITAR applying here.
#### Issues Found
Currently, only one issue has been found with the design: the 22uf decoupling cap for the battery has too low of a voltage rating and should instead be populated with one of the 10uf ones.
#### Component BOM
|Item                              |Description               |Link                                                                                                                                                |Quantity|Unit Price|Item Subtotal     |Remarks                                                                                                                           |
|----------------------------------|--------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|--------|----------|------------------|----------------------------------------------------------------------------------------------------------------------------------|
|STM32U585CIU6Q                    |Main microcontroller      |https://www.mouser.com/ProductDetail/STMicroelectronics/STM32U585CIU6Q?qs=DRkmTr78QARvYPKFvAP2GQ%3D%3D                                              |2       |$9.06     |$18.12            |                                                                                                                                  |
|STM32U073CCU6                     |Peripheral microcontroller|https://www.lcsc.com/product-detail/C22455185.html?s_z=n_STM32U073CCU6                                                                              |2       |$2.63     |$5.26             |                                                                                                                                  |
|AT25SF081B                        |1mb External Flash        |https://www.mouser.com/ProductDetail/Renesas-Dialog/AT25SF081B-SSHB-B?qs=IS%252B4QmGtzzo17GS9scB1nw%3D%3D                                           |2       |$0.35     |$0.70             |original planned chip is https://www.mouser.com/ProductDetail/Renesas-Dialog/AT25SF041B-SSHB-B?qs=IS%252B4QmGtzzpXYmyz2tD79g%3D%3D|
|104031-0811                       |Micro SD Connector        |https://www.lcsc.com/product-detail/C585350.html?s_z=n_104031-0811                                                                                  |2       |$0.76     |$1.52             |                                                                                                                                  |
|ECS-160-8-36B2-CKM-TR             |16mhz HSE Oscillator      |https://www.mouser.com/ProductDetail/ECS/ECS-160-8-36B2-CKM-TR?qs=QNEnbhJQKvaIQPndV3OLHg%3D%3D                                                      |2       |$0.29     |$0.58             |                                                                                                                                  |
|CM7V-T1A-32.768kHz-9pF-10PPM-TA-QC|32.768 khz LSE Oscillator |https://www.mouser.com/ProductDetail/Micro-Crystal/CM7V-T1A-32.768kHz-9pF-10PPM-TA-QC?qs=7bTaA%2FLYtSbcWt4HcA5rHA%3D%3D                             |4       |$0.48     |$1.92             |                                                                                                                                  |
|IRFR9014PBF                       |P channel FET             |https://www.lcsc.com/product-detail/C727638.html?s_z=n_IRFR9014PBF                                                                                  |4       |$0.71     |$2.84             |                                                                                                                                  |
|MMBT2222A-TP                      |NPN BJT                   |https://www.mouser.com/ProductDetail/Micro-Commercial-Components-MCC/MMBT2222A-TP?qs=KFo7JewZbUE%252BJc5W0eD55w%3D%3D                               |6       |$0.10     |$0.60             |                                                                                                                                  |
|DMN3404L-7                        |N channel FET             |https://www.lcsc.com/product-detail/C155257.html?s_z=n_DMN3404L-7                                                                                   |15      |$0.08     |$1.23             |Only need 12                                                                                                                      |
|MMC5983MA                         |Magnetometer              |https://www.mouser.com/ProductDetail/MEMSIC/MMC5983MA?qs=B6kkDfuK7%2FD5qasHMdEt2g%3D%3D                                                             |2       |$2.79     |$5.58             |                                                                                                                                  |
|H3LIS331DLTR                      |High G Accelerometer      |https://www.mouser.com/ProductDetail/STMicroelectronics/H3LIS331DLTR?qs=TAo1I7FhABsAZFqkqNUSRA%3D%3D                                                |0       |$10.24    |$0.00             |not populating                                                                                                                    |
|MAX-M10S-00B                      |GPS module                |https://www.lcsc.com/product-detail/C4153167.html?s_z=n_MAX-M10S-00B                                                                                |2       |$10.26    |$20.52            |                                                                                                                                  |
|PS1240P02BT                       |Piezo                     |https://www.lcsc.com/product-detail/C76871.html?s_z=n_PS1240P02BT                                                                                   |2       |$0.16     |$0.32             |                                                                                                                                  |
|BLM15AX102SN1D                    |Ferrite bead              |https://www.mouser.com/ProductDetail/Murata-Electronics/BLM15AX102SN1D?qs=MY6wChARw2zFsmOR09MDxg%3D%3D                                              |10      |$0.05     |$0.48             |Only need 6                                                                                                                       |
|U.FL-R-SMT-1(10)                  |U.FL Connector            |https://www.lcsc.com/product-detail/C88373.html?s_z=n_U.FL-R-SMT-1%2810%29                                                                          |5       |$0.19     |$0.97             |Only need 4                                                                                                                       |
|LR2021IMLTRT                      |Lora chip                 |https://www.digikey.com/en/products/detail/semtech-corporation/LR2021IMLTRT/28324813?s=N4IgTCBcDaIDICUwAYwEYCSBZOAVBuIAugL5A                        |2       |$9.46     |$18.92            |ships 12/31/25                                                                                                                    |
|ICM-45686                         |IMU                       |https://www.digikey.com/en/products/detail/tdk-invensense/ICM-45686/24374985                                                                        |4       |$5.86     |$23.44            |ships 3/31/26                                                                                                                     |
|BMP581                            |Barometric Pressure Sensor|https://www.lcsc.com/product-detail/C5362283.html?s_z=n_BMP581                                                                                      |2       |$2.17     |$4.34             |                                                                                                                                  |
|ECS-TXO-25CSMV-320-AM-TR          |32mhz TXCO                |https://www.mouser.com/ProductDetail/ECS/ECS-TXO-25CSMV-320-AM-TR?qs=wnTfsH77Xs7GjCu67eLygA%3D%3D                                                   |2       |$2.84     |$5.68             |                                                                                                                                  |
|MPM3610AGQV-Z                     |Buck converter            |https://www.mouser.com/ProductDetail/Monolithic-Power-Systems-MPS/MPM3610AGQV-Z?qs=ZNK0BnemlqFKL2BkndmY4g%3D%3D                                     |2       |$2.42     |$4.84             |                                                                                                                                  |
|MAMK2520H2R2M                     |2.2uH 2.2A Inductor       |https://www.mouser.com/ProductDetail/TAIYO-YUDEN/MAMK2520H2R2M?qs=4JX4e57RtWy63Hw12ZxQ0w%3D%3D                                                      |2       |$0.15     |$0.30             |                                                                                                                                  |
|GRM155R71H104KE14D                |100nF 0402 cap            |https://www.lcsc.com/product-detail/C77020.html?s_z=n_GRM155R71H104KE14D                                                                            |100     |$0.00     |$0.31             |Only need 48                                                                                                                      |
|GRM188R61A105KA61D                |1uF 0603 cap              |https://www.lcsc.com/product-detail/C86012.html?s_z=n_GRM188R61A105KA61D                                                                            |50      |$0.01     |$0.47             |Only need 12                                                                                                                      |
|GRM188R61E225KA12D                |2.2uF 0603 cap            |https://www.mouser.com/ProductDetail/Murata-Electronics/GRM188R61E225KA12D?qs=sGAEpiMZZMvsSlwiRhF8qgBc0KTss%2FnAzZ%252Bjfqmw4BE%3D                  |10      |$0.04     |$0.36             |Only need 8                                                                                                                       |
|GRM188R61E475KE11D                |4.7uF 0603 cap            |https://www.digikey.com/en/products/detail/murata-electronics/GRM188R61E475KE11D/3900465?s=N4IgTCBcDaIOICUCyBGAHGhA2FBRALAOwCsA0riigCIgC6AvkA       |2       |$0.08     |$0.16             |                                                                                                                                  |
|GRM188R61E106KA73D                |10uF 0603 cap             |https://www.lcsc.com/product-detail/C344022.html?s_z=n_GRM188R61E106KA73D                                                                           |20      |$0.03     |$0.62             |Only need 14                                                                                                                      |
|GRM188R60J226MEA0D                |22uF 0603 cap             |https://www.lcsc.com/product-detail/C77042.html?s_z=n_GRM188R60J226MEA0D                                                                            |50      |$0.01     |$0.51             |only need 4                                                                                                                       |
|GJM1555C1H1R8BB01D                |1.8pF 0402 cap            |https://www.mouser.com/ProductDetail/Murata-Electronics/GJM1555C1H1R8BB01D?qs=sGAEpiMZZMvsSlwiRhF8qt9%2FvnstPUzlu%252BDzrUdXIMo%3D                  |10      |$0.04     |$0.36             |only need 4                                                                                                                       |
|GJM1555C1H2R2BB01D                |2.2pF 0402 cap            |https://www.mouser.com/ProductDetail/Murata-Electronics/GJM1555C1H2R2BB01D?qs=sGAEpiMZZMvsSlwiRhF8qsiXmy82%252BWKHWTNzQ0Q03SU%3D                    |2       |$0.10     |$0.20             |                                                                                                                                  |
|GJM1555C1H3R9BB01D                |3.9pF 0402 cap            |https://www.mouser.com/ProductDetail/Murata-Electronics/GJM1555C1H3R9BB01D?qs=sGAEpiMZZMvsSlwiRhF8qnxGm16OHeZjDXy7L7Xmsn4%3D                        |2       |$0.10     |$0.20             |                                                                                                                                  |
|GJM1555C1H7R5CB01J                |7.5pF 0402 cap            |https://www.mouser.com/ProductDetail/Murata-Electronics/GJM1555C1H7R5CB01J?qs=sGAEpiMZZMvsSlwiRhF8qnaoi2Fm8R542h504YCXKV4%3D                        |2       |$0.10     |$0.20             |                                                                                                                                  |
|GCM1555C1H8R0BA16D                |8pF 0402 cap              |https://www.mouser.com/ProductDetail/Murata-Electronics/GCM1555C1H8R0BA16D?qs=sGAEpiMZZMvsSlwiRhF8qiE2qjJvMbsZW2NogaBF05IeDoLfwnic2w%3D%3D          |10      |$0.03     |$0.28             |hse loading - only need 4                                                                                                         |
|GCM1555C1H9R0BA16D                |9pF 0402 cap              |https://www.mouser.com/ProductDetail/Murata-Electronics/GCM1555C1H9R0BA16D?qs=sGAEpiMZZMvsSlwiRhF8qiE2qjJvMbsZOuagzsCW91NzeK7nQoZXyQ%3D%3D          |10      |$0.03     |$0.32             |lse loading - only need 8                                                                                                         |
|GJM1555C1H180GB01D                |18pF 0402 cap             |https://www.mouser.com/ProductDetail/Murata-Electronics/GJM1555C1H180GB01D?qs=sGAEpiMZZMvsSlwiRhF8qnxGm16OHeZjQzgmMU3FLpQ%3D                        |2       |$0.13     |$0.26             |                                                                                                                                  |
|GJM1555C1H220GB01D                |22pF 0402 cap             |https://www.mouser.com/ProductDetail/Murata-Electronics/GJM1555C1H220GB01D?qs=sGAEpiMZZMvsSlwiRhF8qn%2FMY8sF09EMO4lB7wgiHr8doSqMFP%252B%2Fnw%3D%3D  |2       |$0.11     |$0.22             |                                                                                                                                  |
|GJM1555C1H470GB01D                |47pF 0402 cap             |https://www.mouser.com/ProductDetail/Murata-Electronics/GJM1555C1H470GB01D?qs=sGAEpiMZZMvsSlwiRhF8qn%2FMY8sF09EM37VrBGgfPYvu2%252Bt0KXD%252BJQ%3D%3D|2       |$0.12     |$0.24             |                                                                                                                                  |
|TBC05-02-1-G-G                    |1x2 screw terminal        |https://www.mouser.com/ProductDetail/GCT/TBC05-02-1-G-G?qs=bN4HulGPsrHLrim%252BCGLcjw%3D%3D                                                         |6       |$0.58     |$3.48             |                                                                                                                                  |
|TBC05-04-1-G-G                    |1x4 screw terminal        |https://www.mouser.com/ProductDetail/GCT/TBC05-04-1-G-G?qs=bN4HulGPsrGVuxmfCAT6Qw%3D%3D                                                             |2       |$1.10     |$2.20             |                                                                                                                                  |
|TBC05-06-1-G-G                    |1x6 screw terminal        |https://www.mouser.com/ProductDetail/GCT/TBC05-06-1-G-G?qs=bN4HulGPsrG4e4SX9LRrHA%3D%3D                                                             |4       |$1.53     |$6.12             |really need a 1x12, but 2 1x6 is cheaper                                                                                          |
|CRCW04021K00JNED                  |1k resistor               |https://www.lcsc.com/product-detail/C191588.html?s_z=n_CRCW04021K00JNED                                                                             |100     |$0.00     |$0.32             |Only need 24                                                                                                                      |
|CRCW04022K70FKED                  |2.7k resistor             |https://www.mouser.com/ProductDetail/Vishay/CRCW04022K70FKED?qs=sGAEpiMZZMvdGkrng054t6Xa2LxgriWwUkXCYer2Hwg%3D                                      |10      |$0.02     |$0.18             |Only need 8                                                                                                                       |
|CRCW04023K00FKED                  |3k resistor               |https://www.mouser.com/ProductDetail/Vishay/CRCW04023K00FKED?qs=sGAEpiMZZMvdGkrng054txEw7b1YnvGuSEKdBeHn3Bo%3D                                      |10      |$0.02     |$0.17             |Only need 4                                                                                                                       |
|CRCW04025K10FKED                  |5.1k resistor             |https://www.mouser.com/ProductDetail/Vishay/CRCW04025K10FKED?qs=sGAEpiMZZMvdGkrng054t0zI%252BHNuRSaXvngU83TO%252Bv8%3D                              |10      |$0.02     |$0.17             |Only need 8                                                                                                                       |
|CRCW040210K0FKEE                  |10k resistor              |https://www.lcsc.com/product-detail/C843837.html?s_z=n_CRCW040210K0FKEE                                                                             |100     |$0.00     |$0.39             |Only need 18                                                                                                                      |
|CRCW040212K0FKED                  |12k resistor              |https://www.mouser.com/ProductDetail/Vishay/CRCW040212K0FKED?qs=sGAEpiMZZMvdGkrng054tygjBeyq%2FOAO%252Bz7tlBzHp88%3D                                |10      |$0.02     |$0.18             |Only need 4                                                                                                                       |
|CRCW040224K0FKED                  |24k resistor              |https://www.mouser.com/ProductDetail/Vishay/CRCW040224K0FKED?qs=sGAEpiMZZMvdGkrng054tygjBeyq%2FOAOoM47nabpsJQ%3D                                    |10      |$0.02     |$0.18             |Only need 2                                                                                                                       |
|CRCW040239K0FKED                  |39k resistor              |https://www.mouser.com/ProductDetail/Vishay/CRCW040239K0FKED?qs=sGAEpiMZZMvdGkrng054txEw7b1YnvGuEn4Q9wL6tXk%3D                                      |10      |$0.02     |$0.18             |Only need 2                                                                                                                       |
|CRCW040275K0FKED                  |75k resistor              |https://www.mouser.com/ProductDetail/Vishay/CRCW040275K0FKED?qs=sGAEpiMZZMvdGkrng054txEw7b1YnvGuI6hvjmzti8Y%3D                                      |10      |$0.02     |$0.18             |Only need 2                                                                                                                       |
|CRCW0402100KFKEE                  |100k resistor             |https://www.mouser.com/ProductDetail/Vishay/CRCW0402100KFKEE?qs=sGAEpiMZZMvdGkrng054t2vOtRXP5JLECSjEynNmftc%3D                                      |10      |$0.02     |$0.16             |Only need 4                                                                                                                       |
|LQM18PN2R2MGHD                    |2.2uH 0603 inductor       |https://www.mouser.com/ProductDetail/Murata-Electronics/LQM18PN2R2MGHD?qs=jHkklCh7amjVfWhcJgCRwA%3D%3D                                              |2       |$0.20     |$0.40             |                                                                                                                                  |
|LQG15WH3N9B02D                    |3.9nH 0402 inductor       |https://www.mouser.com/ProductDetail/Murata-Electronics/LQG15WH3N9B02D?qs=d0WKAl%252BL4KbQwH8c2ZZRzQ%3D%3D                                          |2       |$0.19     |$0.38             |                                                                                                                                  |
|LQG15WZ4N7B02D                    |4.7nH 0402 inductor       |https://www.mouser.com/ProductDetail/Murata-Electronics/LQG15WZ4N7B02D?qs=d0WKAl%252BL4KZdmcfZ11LVwg%3D%3D                                          |2       |$0.17     |$0.34             |                                                                                                                                  |
|LQG15WZ7N5H02D                    |7.5nH 0402 inductor       |https://www.mouser.com/ProductDetail/Murata-Electronics/LQG15WZ7N5H02D?qs=qkDYIeTQ%252BEnIAjJ%252B%2FhhVqg%3D%3D                                    |2       |$0.10     |$0.20             |                                                                                                                                  |
|LQW15AN12NJ00D                    |12nH 0402 inductor        |https://www.mouser.com/ProductDetail/Murata-Electronics/LQW15AN12NJ00D?qs=iw6lWa%2F%2FJPMQRYLbv%252BB7LA%3D%3D                                      |2       |$0.10     |$0.20             |                                                                                                                                  |
|LQW15AN22NG00D                    |22nH 0402 inductor        |https://www.mouser.com/ProductDetail/Murata-Electronics/LQW15AN22NG00D?qs=L0gQqYTeSd%2F0iBJVNyw3oQ%3D%3D                                            |2       |$0.11     |$0.22             |                                                                                                                                  |
|LQG15WZ24NH02D                    |24nH 0402 inductor        |https://www.mouser.com/ProductDetail/Murata-Electronics/LQG15WZ24NH02D?qs=rkhjVJ6%2F3EIiSVOLbKh2ow%3D%3D                                            |2       |$0.10     |$0.20             |                                                                                                                                  |
|USB4085-GF-A                      |usb c connector           |https://www.mouser.com/ProductDetail/GCT/USB4085-GF-A?qs=KUoIvG%2F9Ilba1bQOahfWjw%3D%3D                                                             |4       |$0.88     |$3.52             |                                                                                                                                  |
|STPS0520Z                         |schottky diode            |https://www.mouser.com/ProductDetail/STMicroelectronics/STPS0520Z?qs=1tTY8DFIKACOdOblhuhK%252BA%3D%3D                                               |2       |$0.13     |$0.26             |prevents backpowering usb                                                                                                         |
|GRM155R71H103JA88D                |10nf capacitor            |https://www.mouser.com/ProductDetail/Murata-Electronics/GRM155R71H103JA88D?qs=18WYLvqSxEpQeSHF5ZnUyQ%3D%3D                                          |10      |$0.02     |$0.18             |gps bias t - only need 2                                                                                                          |
|MCT0603PD1009DP500                |10ohm .25w 0603 resistor  |https://www.mouser.com/ProductDetail/Vishay-Beyschlag/MCT0603PD1009DP500?qs=5aG0NVq1C4wVEQ1hnojWdQ%3D%3D                                            |2       |$0.16     |$0.32             |gps bias t                                                                                                                        |
|LQG15HN27NH02D                    |27nH 0402 inductor        |https://www.mouser.com/ProductDetail/Murata-Electronics/LQG15HN27NH02D?qs=60uY6ySkanRwt2aoTraaAQ%3D%3D                                              |2       |$0.10     |$0.20             |gps bias t                                                                                                                        |
|                                  |                          |                                                                                                                                                    |        |          |**Component Subtotal**|                                                                                                                                  |
|                                  |                          |                                                                                                                                                    |        |          |$143.21           |BoM is for 2 board's worth of components                                                                                          |
|                                  |                          |                                                                                                                                                    |        |          |**Estimated Tariffs** |                                                                                                                                  |
|                                  |                          |                                                                                                                                                    |        |          |$15.72            |                                                                                                                                  |
|                                  |                          |                                                                                                                                                    |        |          |**Shipping**          |                                                                                                                                  |
|                                  |                          |                                                                                                                                                    |        |          |$9.98             |                                                                                                                                  |
|                                  |                          |                                                                                                                                                    |        |          |**Estimated Tax**     |                                                                                                                                  |
|                                  |                          |                                                                                                                                                    |        |          |$13.79            |                                                                                                                                  |
|                                  |                          |                                                                                                                                                    |        |          |**Component Total**   |                                                                                                                                  |
|                                  |                          |                                                                                                                                                    |        |          |$182.69           |See table below for actual cart costs                                                                                             |

#### Carts
|                                  |                          |                                                                                                                                                    |
|----------------------------------|--------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
|**Mouser Cart**                       |**Digikey Cart**              |**LCSC Cart**                                                                                                                                           |
|$89.52                            |$51.34                    |$38.44                                                                                                                                              |
|**Component Total**                   |                          |                                                                                                                                                    |
|$179.30                           |                          |                                                                                                                                                    |
|**JLC Cart**                          |                          |                                                                                                                                                    |
|$42.85                            |note: not included in above table|                                                                                                                                                    |
|**Final Total**                       |                          |                                                                                                                                                    |
|$222.15                           |                          |                                                                                                                                                    |
